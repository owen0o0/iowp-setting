/* 
 * v1.0.1
 */

"use strict";!function(e){e.fn.iset_dependency=function(){return this.each(function(){var t=e(this),i=t.find("[data-controller]");if(i.length){var a=e.iset_deps.createRuleset(),n=e.iset_deps.createRuleset(),s=[],r=[];i.each(function(){var t=e(this),i=t.data("controller").split("|"),o=t.data("condition").split("|"),d=t.data("value").toString().split("|"),l=!!t.data("depend-global"),c=l?n:a;e.each(i,function(e,i){var a=d[e]||"",n=o[e]||o[0];c=c.createRule('[data-depend-id="'+i+'"]',n,a),c.include(t),l?r.push(i):s.push(i)})}),s.length&&e.iset_deps.enable(t,a,s),r.length&&e.iset_deps.enable(e(".iset-section-group"),n,r)}})},e.fn.iset_field_wp_editor=function(){return this.each(function(){if(void 0!==window.wp.editor&&void 0!==window.tinyMCEPreInit&&void 0!==window.tinyMCEPreInit.mceInit.iset_wp_editor){var t=e(this),i=t.find(".iset-wp-editor"),a=t.find("textarea");(t.find(".wp-editor-wrap").length||t.find(".mce-container").length)&&(i.empty(),i.append(a),a.css("display",""));var n="iset-editor-"+Math.random().toString(36).substr(2,9);a.attr("id",n);var s={tinymce:window.tinyMCEPreInit.mceInit.iset_wp_editor,quicktags:window.tinyMCEPreInit.qtInit.iset_wp_editor},r=i.data("editor-settings"),o=wp.oldEditor?wp.oldEditor:wp.editor;o&&o.hasOwnProperty("autop")&&(wp.editor.autop=o.autop,wp.editor.removep=o.removep,wp.editor.initialize=o.initialize);var d=function(e){e.on("change keyup",function(){var t=r.wpautop?e.getContent():wp.editor.removep(e.getContent());a.val(t).trigger("change")})};s.tinymce=e.extend({},s.tinymce,{selector:"#"+n,setup:d}),!1===r.tinymce&&(s.tinymce=!1,i.addClass("iset-no-tinymce")),!1===r.quicktags&&(s.quicktags=!1,i.addClass("iset-no-quicktags"));var l=setInterval(function(){t.is(":visible")&&(window.wp.editor.initialize(n,s),clearInterval(l))});if(r.media_buttons&&window.iset_media_buttons){var c=i.find(".wp-media-buttons");if(c.length)c.find(".iset-shortcode-button").data("editor-id",n);else{var p=e(window.iset_media_buttons);p.find(".iset-shortcode-button").data("editor-id",n),i.prepend(p)}}}})},e.fn.iset_field_file=function(){return this.each(function(){var t,i=e(this),a=i.find("input"),n=i.find(".iset-browse"),s=i.find(".iset-remove"),r=i.find(".iset-preview"),o=i.find(".iset-src"),d=n.data("library")&&n.data("library").split(",")||"";n.on("click",function(e){if(e.preventDefault(),void 0!==window.wp&&window.wp.media&&window.wp.media.gallery){if(t)return void t.open();t=window.wp.media({library:{type:d}}),t.on("select",function(){var e=t.state().get("selection").first().attributes;d.length&&-1===d.indexOf(e.subtype)&&-1===d.indexOf(e.type)||a.val(e.url).trigger("change")}),t.open()}}),s.on("click",function(e){e.preventDefault(),a.val("").trigger("change")}),a.on("change",function(t){var i=a.val();i?s.removeClass("hidden"):s.addClass("hidden"),r.length&&(-1!==e.inArray(i.split(".").pop().toLowerCase(),["jpg","jpeg","gif","png","svg","webp"])?(r.removeClass("hidden"),o.attr("src",i)):r.addClass("hidden"))})})},"function"==typeof Color&&(Color.prototype.toString=function(){if(this._alpha<1)return this.toCSS("rgba",this._alpha).replace(/\s+/g,"");var e=parseInt(this._color,10).toString(16);if(this.error)return"";if(e.length<6)for(var t=6-e.length-1;t>=0;t--)e="0"+e;return"#"+e});var t=function(e){var t=e.replace(/\s+/g,""),i=-1!==t.indexOf("rgba")?parseFloat(100*t.replace(/^.*,(.+)\)/,"$1")):100;return{value:t,transparent:i,rgba:i<100}};e.fn.iset_field_color=function(){return this.each(function(){var i,a=e(this),n=t(a.val()),s=!window.iset_vars.color_palette.length||window.iset_vars.color_palette;a.hasClass("wp-color-picker")&&a.closest(".wp-picker-container").after(a).remove(),a.wpColorPicker({palettes:s,change:function(e,t){var n=t.color.toString();1===t.color._alpha?a.removeClass("iset-rgba"):a.addClass("iset-rgba"),i.removeClass("iset-transparent-active"),i.find(".iset-transparent-offset").css("background-color",n),a.val(n).trigger("change")},create:function(){i=a.closest(".wp-picker-container");var s=a.data("a8cIris"),r=e('<div class="iset-transparent-wrap"><div class="iset-transparent-slider"></div><div class="iset-transparent-offset"></div><div class="iset-transparent-text"></div><div class="iset-transparent-button">transparent</div></div>').appendTo(i.find(".wp-picker-holder")),o=r.find(".iset-transparent-slider"),d=r.find(".iset-transparent-text"),l=r.find(".iset-transparent-offset"),c=r.find(".iset-transparent-button");"transparent"===a.val()&&i.addClass("iset-transparent-active"),n.transparent<100&&a.addClass("iset-rgba"),c.on("click",function(){"transparent"!==a.val()?(a.val("transparent").trigger("change").removeClass("iris-error"),i.addClass("iset-transparent-active")):(a.val(s._color.toString()).trigger("change"),i.removeClass("iset-transparent-active"))}),o.slider({value:n.transparent,step:1,min:0,max:100,slide:function(e,t){var i=parseFloat(t.value/100);s._color._alpha=i,a.wpColorPicker("color",s._color.toString()),d.text(1===i||0===i?"":i)},create:function(){var e=parseFloat(n.transparent/100),r=e<1?e:"";d.text(r),l.css("background-color",n.value),i.on("click",".wp-picker-clear",function(){s._color._alpha=1,d.text(""),o.slider("option","value",100),i.removeClass("iset-transparent-active"),a.trigger("change")}),i.on("click",".wp-picker-default",function(){var e=t(a.data("default-color")),n=parseFloat(e.transparent/100),r=n<1?n:"";s._color._alpha=n,d.text(r),o.slider("option","value",e.transparent),"transparent"===e.value&&(a.removeClass("iris-error"),i.addClass("iset-transparent-active"))})}})}})})},e.fn.iset_field_chosen=function(){return this.each(function(){var t=e(this),i=t.parent().find(".chosen-container"),a=t.hasClass("iset-chosen-sortable")||!1,n=t.hasClass("iset-chosen-ajax")||!1,s=t.attr("multiple")||!1,r=s?"100%":"auto",o=e.extend({allow_single_deselect:!0,disable_search_threshold:10,width:r,no_results_text:window.iset_vars.i18n.no_results_text},t.data("chosen-settings"));if(i.length&&i.remove(),n){var d=e.extend({data:{type:"post",nonce:""},allow_single_deselect:!0,disable_search_threshold:-1,width:"100%",min_length:2,type_delay:500,typing_text:window.iset_vars.i18n.typing_text,searching_text:window.iset_vars.i18n.searching_text,no_results_text:window.iset_vars.i18n.no_results_text},t.data("chosen-settings"));t.ajaxChosen(d)}else t.chosen(o);if(s){var l=t.parent().find(".iset-hide-select"),c=l.val()||[];t.on("change",function(e,t){t&&t.selected?l.append('<option value="'+t.selected+'" selected="selected">'+t.selected+"</option>"):t&&t.deselected&&l.find('option[value="'+t.deselected+'"]').remove(),void 0!==window.wp.customize&&0===l.children().length&&l.data("customize-setting-link")&&window.wp.customize.control(l.data("customize-setting-link")).setting.set(""),l.trigger("change")}),t.setSelectionOrder(c,!0)}if(a){var p=t.parent().find(".chosen-container"),h=p.find(".chosen-choices");h.bind("mousedown",function(t){e(t.target).is("span")&&t.stopPropagation()}),h.sortable({items:"li:not(.search-field)",helper:"orginal",cursor:"move",placeholder:"search-choice-placeholder",start:function(e,t){t.placeholder.width(t.item.innerWidth()),t.placeholder.height(t.item.innerHeight())},update:function(i,a){var n="",s=t.data("chosen"),r=t.parent().find(".iset-hide-select");h.find(".search-choice-close").each(function(){var t=e(this).data("option-array-index");e.each(s.results_data,function(e,i){i.array_index===t&&(n+='<option value="'+i.value+'" selected>'+i.value+"</option>")})}),r.children().remove(),r.append(n),r.trigger("change")}})}})},e.fn.iset_nav_options=function(){return this.each(function(){var t=e(this),i=e(window),a=t.find("a"),n=e("#toplevel_page_"+iset_vars.menu_slug).find("li"),s=e(".iset-placeholder-field"),r=e(".iset-sidebar:not(.iset-sidebar-all)"),o=e(".iset-sidebar-group"),d=null,l=!1,c=function(t){var i=e('[data-tab-id="'+t+'_tab"]');if("undefined"!=typeof localStorage&&localStorage.setItem("iset_active_tab",t),i.length){a.removeClass("nav-tab-active"),i.addClass("nav-tab-active"),n.removeClass("current"),e('[href="admin.php?page='+iset_vars.menu_slug+"#tab="+t+'"]').parent().addClass("current"),s&&s.hide();var c=e("#"+t+"_tab");if(c.data("depend")||c.iset_dependency(),l?c.fadeIn().data("depend",!0):(l=!0,c.show().data("depend",!0)),s=c,o.length){r.slideUp("fast");var p=e(".iset-sidebar-"+t);p.length>0?(p.slideDown("fast"),d.removeClass("iset-hide")):d.addClass("iset-hide"),e(".iset-sidebar-"+t).slideDown("fast")}}};!function(){e(".iset-sidebar-all").length>0&&o.addClass("iset-sidebar-global"),d=e(".iset-sidebar-group:not(.iset-sidebar-global)"),r.prependTo(".iset-sidebar-group");var t="";window.location.hash?t=window.location.hash.replace("#tab=",""):"undefined"!=typeof localStorage&&(t=localStorage.getItem("iset_active_tab"));var i=e('[data-tab-id="'+t+'_tab"]');i.length||(i=e(".iset-section-nav:first"),t=i.attr("href").replace("#tab=","")),location.hash=i.attr("href"),c(t)}(),i.on("hashchange",function(){var t=window.location.hash.replace("#tab=",""),i=t||e(".iset-section-nav:first").attr("href").replace("#tab=","");c(i)})})}}(jQuery),function(e){e(".iset-no-title").find("td").attr("colspan",2),e(document).ready(function(){e(".iset-nav-options").iset_nav_options(),e(".iset-field-file").iset_field_file(),e(".iset-field-wp_editor").iset_field_wp_editor(),e(".iset-field-select").find(".iset-chosen").iset_field_chosen(),e(".iset-field-color").find(".iset-color-picker").iset_field_color()}),e(document).on("click",".iset-switcher",function(){var t=e(this),i=t.find("input"),a=0;t.hasClass("iset-active")?t.removeClass("iset-active"):(a=1,t.addClass("iset-active")),i.val(a).trigger("change")}),e(document).on("click",".iset-checkbox .checkbox-single",function(){e(this).parent().find(".iset-input").val(Number(e(this).prop("checked"))).trigger("change")})}(jQuery);
