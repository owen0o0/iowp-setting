/* 
 * v1.0.0 
 */

"use strict";!function(e){e.fn.iset_dependency=function(){return this.each(function(){var t=e(this),i=t.find("[data-controller]");if(i.length){var n=e.iset_deps.createRuleset(),a=e.iset_deps.createRuleset(),r=[],s=[];i.each(function(){var t=e(this),i=t.data("controller").split("|"),o=t.data("condition").split("|"),d=t.data("value").toString().split("|"),l=!!t.data("depend-global"),c=l?a:n;e.each(i,function(e,i){var n=d[e]||"",a=o[e]||o[0];c=c.createRule('[data-depend-id="'+i+'"]',a,n),c.include(t),l?s.push(i):r.push(i)})}),r.length&&e.iset_deps.enable(t,n,r),s.length&&e.iset_deps.enable(e(".iset-section-group"),a,s)}})},e.fn.iset_field_wp_editor=function(){return this.each(function(){if(void 0!==window.wp.editor&&void 0!==window.tinyMCEPreInit&&void 0!==window.tinyMCEPreInit.mceInit.iset_wp_editor){var t=e(this),i=t.find(".iset-wp-editor"),n=t.find("textarea");(t.find(".wp-editor-wrap").length||t.find(".mce-container").length)&&(i.empty(),i.append(n),n.css("display",""));var a="iset-editor-"+Math.random().toString(36).substr(2,9);n.attr("id",a);var r={tinymce:window.tinyMCEPreInit.mceInit.iset_wp_editor,quicktags:window.tinyMCEPreInit.qtInit.iset_wp_editor},s=i.data("editor-settings"),o=wp.oldEditor?wp.oldEditor:wp.editor;o&&o.hasOwnProperty("autop")&&(wp.editor.autop=o.autop,wp.editor.removep=o.removep,wp.editor.initialize=o.initialize);var d=function(e){e.on("change keyup",function(){var t=s.wpautop?e.getContent():wp.editor.removep(e.getContent());n.val(t).trigger("change")})};r.tinymce=e.extend({},r.tinymce,{selector:"#"+a,setup:d}),!1===s.tinymce&&(r.tinymce=!1,i.addClass("iset-no-tinymce")),!1===s.quicktags&&(r.quicktags=!1,i.addClass("iset-no-quicktags"));var l=setInterval(function(){t.is(":visible")&&(window.wp.editor.initialize(a,r),clearInterval(l))});if(s.media_buttons&&window.iset_media_buttons){var c=i.find(".wp-media-buttons");if(c.length)c.find(".iset-shortcode-button").data("editor-id",a);else{var p=e(window.iset_media_buttons);p.find(".iset-shortcode-button").data("editor-id",a),i.prepend(p)}}}})},e.fn.iset_field_file=function(){return this.each(function(){var t,i=e(this),n=i.find("input"),a=i.find(".iset-browse"),r=i.find(".iset-remove"),s=i.find(".iset-preview"),o=i.find(".iset-src"),d=a.data("library")&&a.data("library").split(",")||"";a.on("click",function(e){if(e.preventDefault(),void 0!==window.wp&&window.wp.media&&window.wp.media.gallery){if(t)return void t.open();t=window.wp.media({library:{type:d}}),t.on("select",function(){var e=t.state().get("selection").first().attributes;d.length&&-1===d.indexOf(e.subtype)&&-1===d.indexOf(e.type)||n.val(e.url).trigger("change")}),t.open()}}),r.on("click",function(e){e.preventDefault(),n.val("").trigger("change")}),n.on("change",function(t){var i=n.val();i?r.removeClass("hidden"):r.addClass("hidden"),s.length&&(-1!==e.inArray(i.split(".").pop().toLowerCase(),["jpg","jpeg","gif","png","svg","webp"])?(s.removeClass("hidden"),o.attr("src",i)):s.addClass("hidden"))})})},"function"==typeof Color&&(Color.prototype.toString=function(){if(this._alpha<1)return this.toCSS("rgba",this._alpha).replace(/\s+/g,"");var e=parseInt(this._color,10).toString(16);if(this.error)return"";if(e.length<6)for(var t=6-e.length-1;t>=0;t--)e="0"+e;return"#"+e});var t=function(e){var t=e.replace(/\s+/g,""),i=-1!==t.indexOf("rgba")?parseFloat(100*t.replace(/^.*,(.+)\)/,"$1")):100;return{value:t,transparent:i,rgba:i<100}};e.fn.iset_field_color=function(){return this.each(function(){var i,n=e(this),a=t(n.val()),r=!window.iset_vars.color_palette.length||window.iset_vars.color_palette;n.hasClass("wp-color-picker")&&n.closest(".wp-picker-container").after(n).remove(),n.wpColorPicker({palettes:r,change:function(e,t){var a=t.color.toString();1===t.color._alpha?n.removeClass("iset-rgba"):n.addClass("iset-rgba"),i.removeClass("iset-transparent-active"),i.find(".iset-transparent-offset").css("background-color",a),n.val(a).trigger("change")},create:function(){i=n.closest(".wp-picker-container");var r=n.data("a8cIris"),s=e('<div class="iset-transparent-wrap"><div class="iset-transparent-slider"></div><div class="iset-transparent-offset"></div><div class="iset-transparent-text"></div><div class="iset-transparent-button">transparent</div></div>').appendTo(i.find(".wp-picker-holder")),o=s.find(".iset-transparent-slider"),d=s.find(".iset-transparent-text"),l=s.find(".iset-transparent-offset"),c=s.find(".iset-transparent-button");"transparent"===n.val()&&i.addClass("iset-transparent-active"),a.transparent<100&&n.addClass("iset-rgba"),c.on("click",function(){"transparent"!==n.val()?(n.val("transparent").trigger("change").removeClass("iris-error"),i.addClass("iset-transparent-active")):(n.val(r._color.toString()).trigger("change"),i.removeClass("iset-transparent-active"))}),o.slider({value:a.transparent,step:1,min:0,max:100,slide:function(e,t){var i=parseFloat(t.value/100);r._color._alpha=i,n.wpColorPicker("color",r._color.toString()),d.text(1===i||0===i?"":i)},create:function(){var e=parseFloat(a.transparent/100),s=e<1?e:"";d.text(s),l.css("background-color",a.value),i.on("click",".wp-picker-clear",function(){r._color._alpha=1,d.text(""),o.slider("option","value",100),i.removeClass("iset-transparent-active"),n.trigger("change")}),i.on("click",".wp-picker-default",function(){var e=t(n.data("default-color")),a=parseFloat(e.transparent/100),s=a<1?a:"";r._color._alpha=a,d.text(s),o.slider("option","value",e.transparent),"transparent"===e.value&&(n.removeClass("iris-error"),i.addClass("iset-transparent-active"))})}})}})})},e.fn.iset_field_chosen=function(){return this.each(function(){var t=e(this),i=t.parent().find(".chosen-container"),n=t.hasClass("iset-chosen-sortable")||!1,a=t.hasClass("iset-chosen-ajax")||!1,r=t.attr("multiple")||!1,s=r?"100%":"auto",o=e.extend({allow_single_deselect:!0,disable_search_threshold:10,width:s,no_results_text:window.iset_vars.i18n.no_results_text},t.data("chosen-settings"));if(i.length&&i.remove(),a){var d=e.extend({data:{type:"post",nonce:""},allow_single_deselect:!0,disable_search_threshold:-1,width:"100%",min_length:2,type_delay:500,typing_text:window.iset_vars.i18n.typing_text,searching_text:window.iset_vars.i18n.searching_text,no_results_text:window.iset_vars.i18n.no_results_text},t.data("chosen-settings"));t.ajaxChosen(d)}else t.chosen(o);if(r){var l=t.parent().find(".iset-hide-select"),c=l.val()||[];t.on("change",function(e,t){t&&t.selected?l.append('<option value="'+t.selected+'" selected="selected">'+t.selected+"</option>"):t&&t.deselected&&l.find('option[value="'+t.deselected+'"]').remove(),void 0!==window.wp.customize&&0===l.children().length&&l.data("customize-setting-link")&&window.wp.customize.control(l.data("customize-setting-link")).setting.set(""),l.trigger("change")}),t.setSelectionOrder(c,!0)}if(n){var p=t.parent().find(".chosen-container"),h=p.find(".chosen-choices");h.bind("mousedown",function(t){e(t.target).is("span")&&t.stopPropagation()}),h.sortable({items:"li:not(.search-field)",helper:"orginal",cursor:"move",placeholder:"search-choice-placeholder",start:function(e,t){t.placeholder.width(t.item.innerWidth()),t.placeholder.height(t.item.innerHeight())},update:function(i,n){var a="",r=t.data("chosen"),s=t.parent().find(".iset-hide-select");h.find(".search-choice-close").each(function(){var t=e(this).data("option-array-index");e.each(r.results_data,function(e,i){i.array_index===t&&(a+='<option value="'+i.value+'" selected>'+i.value+"</option>")})}),s.children().remove(),s.append(a),s.trigger("change")}})}})},e.fn.iset_nav_options=function(){return this.each(function(){var t=e(this),i=e(window),n=t.find("a"),a=e("#toplevel_page_"+iset_vars.menu_slug).find("li"),r=e(".iset-placeholder-field"),s=!1,o=function(t){var i=e('[data-tab-id="'+t+'_tab"]');if("undefined"!=typeof localStorage&&localStorage.setItem("iset_active_tab",t),i.length){n.removeClass("nav-tab-active"),i.addClass("nav-tab-active"),a.removeClass("current"),e('[href="admin.php?page='+iset_vars.menu_slug+"#tab="+t+'"]').parent().addClass("current"),r&&r.hide();var o=e("#"+t+"_tab");o.data("depend")||o.iset_dependency(),s?o.fadeIn().data("depend",!0):(s=!0,o.show().data("depend",!0)),r=o}};!function(){var t="";window.location.hash?t=window.location.hash.replace("#tab=",""):"undefined"!=typeof localStorage&&(t=localStorage.getItem("iset_active_tab"));var i=e('[data-tab-id="'+t+'_tab"]');i.length||(i=e(".iset-section-nav:first"),t=i.attr("href").replace("#tab=","")),location.hash=i.attr("href"),o(t)}(),i.on("hashchange",function(){var t=window.location.hash.replace("#tab=",""),i=t||e(".iset-section-nav:first").attr("href").replace("#tab=","");o(i)})})}}(jQuery),function(e){e(".iset-no-title").find("td").attr("colspan",2),e(document).ready(function(){e(".iset-nav-options").iset_nav_options(),e(".iset-field-file").iset_field_file(),e(".iset-field-wp_editor").iset_field_wp_editor(),e(".iset-field-select").find(".iset-chosen").iset_field_chosen(),e(".iset-field-color").find(".iset-color-picker").iset_field_color()}),e(document).on("click",".iset-switcher",function(){var t=e(this),i=t.find("input"),n=0;t.hasClass("iset-active")?t.removeClass("iset-active"):(n=1,t.addClass("iset-active")),i.val(n).trigger("change")}),e(document).on("click",".iset-checkbox .checkbox-single",function(){e(this).parent().find(".iset-input").val(Number(e(this).prop("checked"))).trigger("change")})}(jQuery);
